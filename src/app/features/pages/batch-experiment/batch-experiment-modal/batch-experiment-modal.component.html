<form [formGroup]="experimentForm" (ngSubmit)="onSubmit()">
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
    <!-- General Information Section -->
    <div class="bg-white rounded-lg p-6 shadow-sm">
      <h2 class="text-lg font-semibold mb-6 text-gray-900">
        General information
      </h2>

      <div class="space-y-4">
        <div>
          <label
            for="batchId"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Batch ID <span class="text-red-500">*</span>
          </label>
          <input
            pInputText
            id="batchId"
            formControlName="batchId"
            class="w-full"
            placeholder="R01/001"
            type="text"
          />
          @if (formControls['batchId'].invalid && (formControls['batchId'].dirty
          || formControls['batchId'].touched)) { @if
          (formControls['batchId'].errors?.['required']) {
          <small class="text-red-600">Batch ID is required.</small>
          } }
        </div>

        <div>
          <label
            for="operator"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Operator <span class="text-red-500">*</span>
          </label>
          <input
            pInputText
            id="operator"
            formControlName="operator"
            class="w-full"
            placeholder="Enter operator name"
            type="text"
          />
          @if (formControls['operator'].invalid &&
          (formControls['operator'].dirty || formControls['operator'].touched))
          { @if (formControls['operator'].errors?.['required']) {
          <small class="text-red-600">Operator is required.</small>
          } }
        </div>

        <div>
          <label
            for="date"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Date <span class="text-red-500">*</span>
          </label>
          <p-datepicker
            inputId="date"
            formControlName="date"
            [showIcon]="true"
            dateFormat="dd/mm/yy"
            placeholder="DD/MM/YYYY"
          ></p-datepicker>
          @if (formControls['date'].invalid && (formControls['date'].dirty ||
          formControls['date'].touched)) { @if
          (formControls['date'].errors?.['required']) {
          <small class="text-red-600">Date is required.</small>
          } }
        </div>

        <div>
          <label
            for="reactorId"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Reactor ID <span class="text-red-500">*</span>
          </label>
          <p-select
            formControlName="reactorId"
            class="w-full"
            appendTo="body"
            optionLabel="name"
            optionValue="id"
            [options]="reactors.data() || []"
            placeholder="Select status"
            focusOnHover="true"
            checkmark="true"
          />
          @if (formControls['reactorId'].invalid &&
          (formControls['reactorId'].dirty ||
          formControls['reactorId'].touched)) { @if
          (formControls['reactorId'].errors?.['required']) {
          <small class="text-red-600">Reactor ID is required.</small>
          } }
        </div>

        <div>
          <label
            for="blockId"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Block ID <span class="text-red-500">*</span>
          </label>
          <input
            pInputText
            id="blockId"
            formControlName="blockId"
            class="w-full"
            placeholder="B01/001"
            type="text"
          />
          @if (formControls['blockId'].invalid && (formControls['blockId'].dirty
          || formControls['blockId'].touched)) { @if
          (formControls['blockId'].errors?.['required']) {
          <small class="text-red-600">Block ID is required.</small>
          } }
        </div>

        <div class="flex flex-col gap-4">
          <div>
            <label
              for="timeStart"
              class="block text-sm font-medium text-gray-700 mb-2"
            >
              Time start <span class="text-red-500">*</span>
            </label>
            <p-datepicker
              id="timeStart"
              formControlName="timeStart"
              class="w-full"
              placeholder="14:30:30"
              type="time"
              [timeOnly]="true"
            />
            @if (formControls['timeStart'].invalid &&
            (formControls['timeStart'].dirty ||
            formControls['timeStart'].touched)) { @if
            (formControls['timeStart'].errors?.['required']) {
            <small class="text-red-600">Time start is required.</small>
            } }
          </div>

          <div>
            <label
              for="timeEnd"
              class="block text-sm font-medium text-gray-700 mb-2"
            >
              Time end <span class="text-red-500">*</span>
            </label>
            <p-datepicker
              id="timeEnd"
              formControlName="timeEnd"
              class="w-full"
              placeholder="14:35:00"
              [timeOnly]="true"
            />
            @if (formControls['timeEnd'].invalid &&
            (formControls['timeEnd'].dirty || formControls['timeEnd'].touched))
            { @if (formControls['timeEnd'].errors?.['required']) {
            <small class="text-red-600">Time end is required.</small>
            } }
          </div>
        </div>
      </div>
    </div>

    <!-- Material Feedstock Section -->
    <div class="bg-white rounded-lg p-6 shadow-sm">
      <h2 class="text-lg font-semibold mb-6 text-gray-900">
        Material feedstock
      </h2>

      <div class="space-y-4">
        <div>
          <label
            for="mixDesign"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Mix design
          </label>
          <input
            pInputText
            id="mixDesign"
            formControlName="mixDesign"
            class="w-full"
            placeholder="1:2:3"
            type="text"
          />
        </div>

        <div>
          <label
            for="cement"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Cement (kg)
          </label>
          <p-inputNumber
            inputId="cement"
            formControlName="cement"
            [minFractionDigits]="1"
            [maxFractionDigits]="2"
            placeholder="1.2"
            styleClass="w-full"
          ></p-inputNumber>
        </div>

        <div>
          <label
            for="fineAggregate"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Fine Aggregate (kg)
          </label>
          <p-inputNumber
            inputId="fineAggregate"
            formControlName="fineAggregate"
            [minFractionDigits]="1"
            [maxFractionDigits]="2"
            placeholder="2.7"
            styleClass="w-full"
          ></p-inputNumber>
        </div>

        <div>
          <label
            for="coarseAggregate"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Coarse Aggregate (kg)
          </label>
          <p-inputNumber
            inputId="coarseAggregate"
            formControlName="coarseAggregate"
            [minFractionDigits]="1"
            [maxFractionDigits]="2"
            placeholder="4.1"
            styleClass="w-full"
          ></p-inputNumber>
        </div>

        <div>
          <label
            for="water"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Water
          </label>
          <p-inputNumber
            inputId="water"
            formControlName="water"
            [minFractionDigits]="1"
            [maxFractionDigits]="2"
            placeholder="0.6"
            styleClass="w-full"
          ></p-inputNumber>
        </div>

        <div>
          <label
            for="waterCementRatio"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Water cement ratio
          </label>
          <p-inputNumber
            inputId="waterCementRatio"
            formControlName="waterCementRatio"
            [minFractionDigits]="2"
            [maxFractionDigits]="2"
            placeholder="0.55"
            styleClass="w-full"
          ></p-inputNumber>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Block size (mm)
          </label>
          <div class="flex w-3/4 items-center gap-2">
            <p-inputNumber
              formControlName="blockSizeLength"
              [showButtons]="true"
              buttonLayout="vertical"
              spinnerMode="vertical"
              [minFractionDigits]="0"
              [maxFractionDigits]="0"
              placeholder="150"
              class="w-1/4 mr-1"
              size="small"
            ></p-inputNumber>
            <span class="text-gray-500 text-xl">×</span>
            <p-inputNumber
              formControlName="blockSizeWidth"
              [showButtons]="true"
              buttonLayout="vertical"
              spinnerMode="vertical"
              [minFractionDigits]="0"
              [maxFractionDigits]="0"
              placeholder="150"
              class="w-1/4 mr-1"
              size="small"
            ></p-inputNumber>
            <span class="text-gray-500 text-xl">×</span>
            <p-inputNumber
              formControlName="blockSizeHeight"
              [showButtons]="true"
              buttonLayout="vertical"
              spinnerMode="vertical"
              [minFractionDigits]="0"
              [maxFractionDigits]="0"
              placeholder="150"
              class="w-1/4 mr-1"
              size="small"
            ></p-inputNumber>
          </div>
        </div>
      </div>
    </div>

    <!-- Exposure Conditions Section -->
    <div class="bg-white rounded-lg p-6 shadow-sm">
      <h2 class="text-lg font-semibold mb-6 text-gray-900">
        Exposure conditions
      </h2>

      <div class="space-y-4">
        <div class="mb-4">
          <label
            for="reactorStatus"
            class="block text-sm font-medium text-gray-700 ml-2 mb-2"
          >
            Co2 Form
          </label>

          <p-select
            formControlName="co2Form"
            class="w-full"
            focusOnHover="true"
            appendTo="body"
            checkmark="true"
            showClear="true"
            [options]="co2Forms()"
            placeholder="Select CO2 form"
          />
        </div>
        <div>
          <label
            for="waterCementRatio"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Co2 Mass
          </label>
          <p-inputNumber
            inputId="co2Mass"
            formControlName="co2Mass"
            [minFractionDigits]="2"
            [maxFractionDigits]="2"
            placeholder="Enter mass in Gramms"
            styleClass="w-full"
          ></p-inputNumber>
        </div>
        <div>
          <label
            for="waterCementRatio"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Injection Pressure
          </label>
          <p-inputNumber
            inputId="injectionPressure"
            formControlName="injectionPressure"
            [minFractionDigits]="2"
            [maxFractionDigits]="2"
            placeholder="Enter pressure"
            styleClass="w-full"
          ></p-inputNumber>
        </div>
        <div>
          <label
            for="waterCementRatio"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Head Space
          </label>
          <p-inputNumber
            inputId="headSpace"
            formControlName="headSpace"
            [minFractionDigits]="2"
            [maxFractionDigits]="2"
            placeholder="Enter head space"
            styleClass="w-full"
          ></p-inputNumber>
        </div>
        <div>
          <label
            for="waterCementRatio"
            class="block text-sm font-medium text-gray-700 mb-2"
          >
            Reaction Time
          </label>
          <p-inputNumber
            inputId="reactionTime"
            formControlName="reactionTime"
            [minFractionDigits]="2"
            [maxFractionDigits]="2"
            placeholder="Enter reaction time in seconds"
            styleClass="w-full"
          ></p-inputNumber>
        </div>
      </div>
    </div>

    <!-- Sample Tests Section -->
    <div class="bg-white rounded-lg p-6 shadow-sm col-span-1 lg:col-span-3">
      <h2 class="text-lg font-semibold mb-6 text-gray-900">Analytical Tests</h2>

      <div class="space-y-4">
        <div
          class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center pb-4 border-b border-gray-200"
        >
          <div class="text-sm font-medium text-gray-700">TGA mass</div>
          <div>
            <div class="text-sm text-gray-500">Sample ID</div>
            <div>
              <input
                pInputText
                formControlName="tgaSampleId"
                class="w-full"
                placeholder="B01/001/S1"
                type="text"
              />
            </div>
          </div>
          <div>
            <p-fileUpload
              mode="advanced"
              chooseLabel="Pdf"
              [auto]="true"
              (onSelect)="onFileSelect($event, 'tgaFile')"
              accept=".pdf"
              [maxFileSize]="10000000"
            ></p-fileUpload>
          </div>
        </div>
        <div
          class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center pb-4 border-b border-gray-200"
        >
          <div class="text-sm font-medium text-gray-700">XRD notes</div>

          <div>
            <div class="text-sm text-gray-500">Sample ID</div>

            <div>
              <input
                pInputText
                formControlName="xrdSampleId"
                class="w-full"
                placeholder="B01/001/S2"
                type="text"
              />
            </div>
          </div>

          <div>
            <p-fileUpload
              mode="advanced"
              chooseLabel="Pdf"
              [auto]="true"
              (onSelect)="onFileSelect($event, 'xrdFile')"
              accept=".pdf"
              [maxFileSize]="10000000"
            ></p-fileUpload>
          </div>
        </div>

        <div
          class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center pb-4 border-b border-gray-200"
        >
          <div>
            <div class="text-sm font-medium text-gray-700">
              Composition of feedstock
            </div>
            <div>
              <p-fileUpload
                mode="advanced"
                chooseLabel="Pdf"
                [auto]="true"
                (onSelect)="onFileSelect($event, 'compositionFile')"
                accept=".pdf"
                [maxFileSize]="10000000"
              ></p-fileUpload>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Form Actions -->
  <div class="flex justify-end gap-4 bg-white rounded-lg p-6 shadow-sm">
    <p-button
      label="Submit"
      type="submit"
      [disabled]="experimentForm.invalid"
      [loading]="loading()"
    ></p-button>
  </div>
</form>
